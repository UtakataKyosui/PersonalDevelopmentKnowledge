## 書籍概要

*   タイトル: Webアクセシビリティの扉を開く
*   著者: 瀬戸ファクトリー
*   発行: 技術書典 18、2025年 6月 1日、ver 1.0
*   目的: アクセシビリティについて「重要性は理解しているけれど、具体的に何をすればいいかわからない」と感じている人々に向けて、学びの最初の第一歩を後押しすること

## 著者紹介とアクセシビリティに向き合うきっかけ

*   著者らは株式会社ソニックガーデン所属の若手エンジニア。Ruby on Railsを使ってWebアプリケーション開発に携わっている。
*   チーム名「瀬戸ファクトリー」は、愛知県瀬戸市のワークプレイスにちなんで名付けられた。
*   2024年12月の「TechGALA ハッカソン」への参加が、アクセシビリティに向き合う大きなきっかけとなった。
*   このハッカソンで、視覚障害を持ちながらプログラミングを学ぶメンバーと出会い、共に開発に取り組んだ。
*   この出会いを通じて、視覚障害のある方のPC操作や日常生活の課題について、著者自身がいかに無知だったかを思い知らされた。
*   以前は「アクセシビリティは大切。でも、余裕があるときに取り組めば良い」と考えていたが、交流を通じて考えが大きく変わった。
*   アクセシビリティが考慮されないことで、届けたい情報がそもそも届かないという本質的な問題に気づいた。
*   Webサービスが社会に不可欠になった今、誰であってもサービスを利用できる状態を作る責任が開発者にあると感じるようになった。

## 本書の焦点：WAI-ARIA

*   Webアクセシビリティには様々な分野があるが、本書では特に、**音声読み上げに対応したインターフェースを支援するWAI-ARIAという技術**に焦点を当てている。
*   WAI-ARIAの活用方法を実例を交えながら紹介する。

## WAI-ARIAの基本

### WAI-ARIAとは？

*   WAI-ARIA（Web Accessibility Initiative - Accessible Rich Internet Applications）は、Webページ上の「意味」や「状態」を、スクリーンリーダーなどの支援技術に正しく伝えるための仕様。
*   標準のHTMLタグ（`<button>`, `<a>`, `<nav>`など）はそれ自体に意味が備わっており、支援技術でも正しく解釈される。
*   しかし、`<div>`や`<span>`を使って独自に実装した場合、その要素が「ボタンである」「メニューが開いている」といった意味や状態は支援技術に正しく伝わらない。
*   **WAI-ARIAを用いることで、「このdivはボタンとして動作します」「このメニューは現在開いています」といった情報を、明示的に支援技術へ伝えることができる**。

### WAI-ARIAを使うべき場面

*   独自のデザインやインタラクションを実現するため、標準のHTMLタグが使えない場合。
*   モーダルウィンドウ、タブパネル、アコーディオンなど、操作が複雑なUIを構築する場合。
*   開閉・選択・無効化など、要素の状態をスクリーンリーダーに正確に伝える必要がある場合。
*   **可能な限り意味を持つHTMLの標準タグを使うことが基本であり、WAI-ARIAはあくまで標準のタグでは対応できないときに使う補助的な手段**である。

### WAI-ARIAを使う際の注意点

*   できるだけ標準タグを使うこと（例: ボタンは`<button>`、リンクは`<a>`）。
*   WAI-ARIAは必要なときだけ使うこと。
*   **使ったら必ず動作確認すること**。
    *   VoiceOver、NVDAといったスクリーンリーダーを使用する。
    *   キーボード操作を試してみる（Tab移動、Enter、Escキーなど）。

### 基本的なWAI-ARIA属性と使い方

*   **role**: 要素の役割を示す属性。例: `<div role="button">`
*   **aria-label**: 要素にラベルを付ける属性。例: `<button aria-label="閉じる">`
*   **aria-hidden**: 要素を読み上げ対象から除外する属性。例: `<span aria-hidden="true">アイコン</span>`
*   **aria-expanded**: 要素の開閉状態を示す属性。例: `<button aria-expanded="false">メニュー</button>`
*   **aria-controls**: 関連する要素を示す属性。例: `<button aria-controls="menu">`
*   **aria-modal**: モーダル内の操作に限定することを示す属性。例: `<div role="dialog" aria-modal="true">`

## WAI-ARIA実践例（第1章）

*   メニュー開閉
    *   `aria-expanded`で開閉状態を伝える。
    *   `aria-controls`で制御している要素を示す。
*   モーダルウィンドウ
    *   モーダル要素には**`role="dialog"`と`aria-modal="true"`を必ず指定**する。
    *   フォーカスの制御が重要（開閉時のフォーカス移動）。
    *   Escapeキーでの閉じる操作に対応する。
*   タブパネル
    *   `role="tab"`: 個々のタブ
    *   `role="tabpanel"`: 対応するコンテンツ領域
    *   `role="tablist"`: タブのグループ
    *   `aria-selected`で選択状態を示す。
    *   `aria-controls`とidでタブとパネルを紐付ける。
    *   選択されていないタブに`tabindex="-1"`をつけることで、キーボードフォーカスできないようにする。
    *   タブパネルには`aria-labelledby`でラベルをつける必要がある（フォーカス可能にする場合）。
    *   タブ切り替え後、フォーカスが関連パネルへ移動し、内容が読み上げられるようになる。
    *   パネルに`tabindex="0"`を設定することで、タブ移動後にパネル内へキーボードフォーカスが移動しやすくなる。

## 実践編：書籍管理アプリケーションでの対応（第2章）

*   書籍管理アプリケーションを題材に、具体的なアクセシビリティ対応を実践する。簡単な登録・更新・削除・検索機能がある。
*   技術スタック: Ruby on Rails 8.0.2, SQLite3, yarn, Hotwire (Turbo Rails + Stimulus Rails), Bootstrap5など。
*   サンプルアプリの起動方法が示されている。
*   対応前後のプロジェクトがGitHubで公開されている。

### VoiceOverの使い方

*   macOSに標準搭載されているスクリーンリーダー機能「VoiceOver」の使い方を解説。
*   開発者視点も交えながら、本書で扱うアプリケーションへの適用方法を考える。
*   有効化手順（システム設定からオン、またはCommand + F5）が示されている。
*   基本操作（項目移動、テキスト読み上げ、フォーカス移動）が解説されている。
*   項目移動にはControl + Option + ArrowキーやRotor (Control + Option + U) を使う。
*   Tabキー / Shift + Tabキーで、フォーム入力欄やボタンなどフォーカス可能な要素間を移動できる。VoiceOver有効時も通常のTabナビゲーションは機能する。

### 各機能のWAI-ARIA対応

*   **サイドバー**
    *   BootstrapのOffcanvasコンポーネントを利用。JavaScriptを追加せずWAI-ARIA属性のみで対応。
    *   **`aria-controls`と`aria-expanded`**でメニュー開閉状態を伝える。
    *   **`role="dialog"`と`aria-modal="true"`**により、offcanvasがダイアログとして認識される。
    *   **`aria-labelledby`**でタイトル要素を紐付け、開閉時に正しいラベルが読み上げられる。
    *   対応により、スクリーンリーダーでのナビゲーション領域認識向上、開閉状態の即時伝達、Escapeキーでの閉じる操作、Tabキーでのフォーカス移動が自然に行えるようになる。
*   **タブ**
    *   Bootstrapのタブコンポーネントに必要なWAI-ARIA属性を付与。
    *   **`role="tablist"`と`aria-label`**をタブリストに付与し、タブグループを明確化。
    *   各タブに**`role="tab"`, `aria-controls`, `aria-selected`**を追加し、アクティブ/非アクティブ状態を明示化.
    *   パネルに**`role="tabpanel"`, `aria-labelledby`, `tabindex="0"`**を追加し、タブとの関連付けとキーボードフォーカス可能化を実現。
    *   対応により、スクリーンリーダーでの「タブ」認識、選択タブの明確化、タブとパネルの論理的な結びつき、パネル内容の自動読み上げ、パネル内へのキーボードフォーカス移動がスムーズになる。
*   **モーダル**（書籍登録フォーム）
    *   BootstrapとTurbo Frameを組み合わせて実装したモーダルに対し、JavaScriptを追加せずWAI-ARIA属性のみで対応。
    *   モーダル本体に**`role="dialog"`, `aria-modal="true"`**を付与。
    *   **`aria-labelledby`**でヘッダータイトルを参照。
    *   **`aria-describedby`**で本文（フォーム）の説明領域を参照。
    *   対応により、モーダルが開くと自動でフォーカスが移動し`aria-labelledby`で指定したタイトルが読み上げられる。`aria-describedby`によりフォームの説明やエラーメッセージなどがまとめて読み上げられる。閉じるボタンの`aria-label`により操作が明確に伝わる。
*   **書籍検索**（モーダル内）
    *   検索結果がスクリーンリーダーで正しく読み上げられるようにWAI-ARIA属性を追加。Stimulusコントローラの修正も行う。
    *   検索成功メッセージ領域に**`role="status"`と`aria-live="polite"`**を付与することで、内容が更新されるとスクリーンリーダーが読み上げる。
    *   検索中のスピナー要素に**`role="status"`**を付与することで、読み上げはせず視覚的に処理中であることを伝える。
    *   エラーメッセージ要素に**`role="alert"`と`aria-live="assertive"`**を付与することで、エラーメッセージが即座に読み上げられる。

## WAI-ARIA活用事例：Vision Codeの取り組み（第3章）

*   著者自身が開発している「Vision Code」での取り組み事例を紹介。
*   Vision Codeは、視覚障がいのあるプログラマーと晴眼者のプログラマーが円滑にペアプログラミングを行うためのプラットフォーム。コミュニケーションサポートや学習サポート機能がある。
*   アクセシビリティ向上に取り組んだ背景は、視覚障がい当事者のエンジニアからのフィードバック。
*   初期実装のWeb Speech APIを用いた読み上げ機能には、スクリーンリーダーとの互換性や読み上げ速度/音質に課題があった。
*   本プロダクトの主要利用者が視覚障がい者である以上、アクセシビリティ意識は補助ではなく前提条件であると強く認識。
*   具体的な改善として、**Web Speech API、カーソル移動時の読み上げ、コード解説の読み上げ機能をWAI-ARIAに対応**させた。
*   Web Speech APIのWAI-ARIA対応では、**`aria-live="polite"` `aria-atomic="true"`を持つ非表示の要素**をHTMLに追加し、そこにJavaScriptで読み上げたいテキストを挿入する方法を用いた。
*   **`setTimeout`を使って一度テキストを空にしてから再挿入**するのは、スクリーンリーダーに「内容が変化した」ことを確実に認識させるため。
*   カーソル移動時の読み上げやコード解説の読み上げでも、この`aria-live`領域にメッセージを渡す方法を再利用している。これにより、スクリーンリーダーがリアルタイムに読み上げる。

## 終わりに

*   アクセシビリティ対応は、完璧を目指すのではなく、「**できることから少しずつ**」がポイント。
*   最初にできることとして、**正しいHTMLタグの使用、画像へのalt属性、キーボード操作対応**が挙げられている。
*   役立つチェックツールとして、**axe DevTools、a11y-visualizer、Lighthouse**が紹介されている。
*   さらに学ぶためのリソースも紹介されている（書籍、W3Cサイトなど）。
